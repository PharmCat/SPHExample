<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · SPHExample</title><meta name="title" content="Home · SPHExample"/><meta property="og:title" content="Home · SPHExample"/><meta property="twitter:title" content="Home · SPHExample"/><meta name="description" content="Documentation for SPHExample."/><meta property="og:description" content="Documentation for SPHExample."/><meta property="twitter:description" content="Documentation for SPHExample."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>SPHExample</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#SPH-Example"><span>SPH Example</span></a></li><li><a class="tocitem" href="#Description"><span>Description</span></a></li><li><a class="tocitem" href="#Getting-Started"><span>Getting Started</span></a></li><li><a class="tocitem" href="#Help"><span>Help</span></a></li><li><a class="tocitem" href="#Authors"><span>Authors</span></a></li><li><a class="tocitem" href="#Version-History"><span>Version History</span></a></li><li><a class="tocitem" href="#License"><span>License</span></a></li><li><a class="tocitem" href="#Acknowledgments"><span>Acknowledgments</span></a></li></ul></li><li><a class="tocitem" href="functions/">Functions</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/PharmCat/SPHExample" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/PharmCat/SPHExample/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="SPHExample"><a class="docs-heading-anchor" href="#SPHExample">SPHExample</a><a id="SPHExample-1"></a><a class="docs-heading-anchor-permalink" href="#SPHExample" title="Permalink"></a></h1><h1 id="SPH-Example"><a class="docs-heading-anchor" href="#SPH-Example">SPH Example</a><a id="SPH-Example-1"></a><a class="docs-heading-anchor-permalink" href="#SPH-Example" title="Permalink"></a></h1><p>An example of how to write a relatively simple SPH (Smoothed Particle Hydrodynamics) dam-break simulation in Julia. Feel free to star the package if it helped you and please do let me know if you ended up using this to learn SPH yourself, used it in your teaching etc. It is really a motivation booster to hear!</p><p>If for some reason you end up pointing to this repository due to you writing a thesis, paper etc., I would love to know!</p><p>The code can produce a 2D dam-break (<a href="https://www.youtube.com/watch?v=7kDVjZkc_TI">@DamBreak2D-Video</a>):</p><p><img src="https://github.com/AhmedSalih3d/SPHExample/blob/414bf2adcb13b20abce9453b1f73acdbc7b1c909/images/2d_dambreak.png" alt="plot"/></p><p>Or if you are really patient (1+ day to calculate) a 3D case (<a href="https://www.youtube.com/watch?v=_2e6LopvIe8">@DamBreak3D-Video</a>)::</p><p><img src="https://github.com/AhmedSalih3d/SPHExample/blob/414bf2adcb13b20abce9453b1f73acdbc7b1c909/images/3d_dambreak.png" alt="plot"/></p><h2 id="Description"><a class="docs-heading-anchor" href="#Description">Description</a><a id="Description-1"></a><a class="docs-heading-anchor-permalink" href="#Description" title="Permalink"></a></h2><p>The purpose of this code is to serve as an introduction to the SPH (Smoothed Particle Hydrodynamics) method. I have been working in SPH for quite a few years now and noticed that although great software packages exist in this field, it was difficult to find a &quot;simple&quot; example of setting up an SPH solver.</p><p>To fill this &quot;void&quot; I decided to go about writing one and learning the necessary steps to do so. The choice of language was Julia, since I&#39;ve been part of this community for some years and really believe in the concept behind Julia. Also it is a language with a syntax complexity level of around Python, so it would still serve as good inspiration for others wanting to write their own dam break code to look through this.</p><p>Key-elements of the code are:</p><ul><li>Weakly Compressible SPH<ul><li>Density varies about ~1% in time, for numerical reasons and the pressure equation is based on the density</li></ul></li><li>Single threaded approach<ul><li>For simplicity since I consider this a teaching example. Commercial scale SPH should always be done on GPU&#39;s anyways.</li></ul></li><li>Dynamic Boundary Condition (as in DualSPHysics)<ul><li>DualSPHysics is one of the most well-known SPH packages. Thought it would be a good idea to show how one implements this boundary condition.</li></ul></li><li>Density Diffusion<ul><li>Necessary to produce a non-noise density field, which is important for the momentum equation, since pressure is a function of density in weakly compressible SPH</li></ul></li><li>Wendland Quintic Kernel (as in DualSPHysics)<ul><li>One of the simpler kernels which does not require tensile correction to be applied.</li></ul></li></ul><p><em>Please</em> remember that this code is not made to be performant. It is made to teach and showcase one way to code a relatively simple SPH dam break.</p><h2 id="Getting-Started"><a class="docs-heading-anchor" href="#Getting-Started">Getting Started</a><a id="Getting-Started-1"></a><a class="docs-heading-anchor-permalink" href="#Getting-Started" title="Permalink"></a></h2><h3 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h3><pre><code class="nohighlight hljs">import Pkg
Pkg.add(url = &quot;https://github.com/AhmedSalih3d/SPHExample.git&quot;)</code></pre><h3 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h3><p>The package is structured into &quot;input&quot;, &quot;example&quot; and &quot;src&quot;. &quot;input&quot; contains some pre-generated particle layouts from DualSPHysics in .csv format. These paths are specified in the &quot;RunSimulation&quot; function found in &quot;example/MainSimulation.jl&quot;, not as an input but as something which should be changed inside the function and recompiled. After installing the package, run the code in &quot;example/MainSimulation.jl&quot; to start your first simulation. </p><p>The &quot;src&quot; package contains all the code files used in this process. An overview of these is shown;</p><ul><li>PreProcess<ul><li>Function for loading in the files in &quot;input&quot;</li></ul></li><li>PostProcess<ul><li>Function to output .vtp files</li></ul></li><li>AuxillaryFunctions<ul><li>Not used, but provided as a service to extract all particle ids based on a neighbour list</li></ul></li><li>TimeStepping<ul><li>Some simple time stepping controls</li></ul></li><li>SimulatioNEquations<ul><li>All SPH related physics functions</li></ul></li></ul><p>A few key-packages are used and automatically imported. Listed here for your convenience:</p><ul><li>CellListMap<ul><li>A package which allows to return an array of tuples consisting of (particle i, particle j, distance between particle i and particle j), which significantly simplifies and speeds up the calculation process.</li></ul></li><li>WriteVTK<ul><li>A package which outputs results calculated in this package to the .vtp format. Remember to view results in Paraview you have to select something other than &quot;Solid Color&quot; and for example &quot;Point Gaussian&quot; instead of &quot;Surface&quot; repesentation.</li></ul></li></ul><p>Without these, this example would have been significantly harder to write - and of course thank you to the Julia eco-system as a whole. </p><h3 id="Executing-program"><a class="docs-heading-anchor" href="#Executing-program">Executing program</a><a id="Executing-program-1"></a><a class="docs-heading-anchor-permalink" href="#Executing-program" title="Permalink"></a></h3><p>In &quot;MainSimulation.jl&quot;  you will find:</p><pre><code class="language-julia hljs">RunSimulation(SaveLocation=&quot;E:/SecondApproach/Results&quot;,SimulationName=&quot;DamBreak&quot;)</code></pre><p>You have to make the save location before hand for the code to work. Then you can call the code using the following syntax from above. Inside the &quot;RunSimulation&quot; function you will find hard coded:</p><pre><code class="language-julia hljs">    ### VARIABLE EXPLANATION
    # FLUID_CSV = PATH TO FLUID PARTICLES, SEE &quot;input&quot; FOLDER
    # BOUND_CSV = PATH TO BOUNDARY PARTICLES, SEE &quot;input&quot; FOLDER
    # ρ₀  = REFERENCE DENSITY
    # dx  = INITIAL PARTICLE DISTANCE, SEE &quot;dp&quot; IN CSV FILES, FOR 3D SIM: 0.0085
    # H   = SMOOTHING LENGTH
    # m₀  = INITIAL MASS (REFERENCE DENSITY * DX^(SIMULATION DIMENSIONS))
    # mᵢ  = mⱼ = m₀ | ALL PARTICLES HAVE THE SAME MASS, ALWAYS
    # αD  = NORMALIZATION CONSTANT FOR KERNEL
    # α   = ARTIFICIAL VISCOSITY ALPHA VALUE
    # g   = GRAVITY (POSITIVE!)
    # c₀  = SPEED OF SOUND, MUST BE 10X HIGHEST VELOCITY IN SIMULATION
    # γ   = GAMMA, MOST COMMONLY 7 FOR WATER, USE FOR PRESSURE EQUATION OF STATE
    # dt  = INITIAL TIME STEP
    # δᵩ  = 0.1 | COEFFICIENT FOR DENSITY DIFFUSION, SHOULD ALWAYS BE 0.1
    # CFL = CFL NUMBER

    ### 2D Dam Break
    FLUID_CSV = &quot;./input/FluidPoints_Dp0.02.csv&quot;
    BOUND_CSV = &quot;./input/BoundaryPoints_Dp0.02.csv&quot;
    ρ₀  = 1000
    dx  = 0.02
    H   = 1.2*sqrt(2)*dx
    m₀  = ρ₀*dx*dx #mᵢ  = mⱼ = m₀
    αD  = (7/(4*π*H^2))
    α   = 0.01
    g   = 9.81
    c₀  = sqrt(g*2)*20
    γ   = 7
    dt  = 1e-5
    δᵩ  = 0.1
    CFL = 0.2</code></pre><p>These parameters have been tested and should work out of the box. Other than these inputs you should not have to change anything else. </p><h2 id="Help"><a class="docs-heading-anchor" href="#Help">Help</a><a id="Help-1"></a><a class="docs-heading-anchor-permalink" href="#Help" title="Permalink"></a></h2><p>Any questions about the code feel free to post an issue on this repository. Please do understand it might take some time for me to respond back.</p><h2 id="Authors"><a class="docs-heading-anchor" href="#Authors">Authors</a><a id="Authors-1"></a><a class="docs-heading-anchor-permalink" href="#Authors" title="Permalink"></a></h2><p>Written by Ahmed Salih <a href="https://github.com/AhmedSalih3d">@AhmedSalih3D</a></p><h2 id="Version-History"><a class="docs-heading-anchor" href="#Version-History">Version History</a><a id="Version-History-1"></a><a class="docs-heading-anchor-permalink" href="#Version-History" title="Permalink"></a></h2><ul><li>Version 0.1 | Release Version</li><li>main        | A cleaned up version of the original release version</li></ul><h2 id="License"><a class="docs-heading-anchor" href="#License">License</a><a id="License-1"></a><a class="docs-heading-anchor-permalink" href="#License" title="Permalink"></a></h2><p>This project is licensed under the MIT License - see the LICENSE.md file for details</p><h2 id="Acknowledgments"><a class="docs-heading-anchor" href="#Acknowledgments">Acknowledgments</a><a id="Acknowledgments-1"></a><a class="docs-heading-anchor-permalink" href="#Acknowledgments" title="Permalink"></a></h2><p>DualSPHysics (https://dual.sphysics.org/) was a great inspiration for this code.</p><p>Thank you to the general Julia eco-system and especially Leandro Martínez (https://github.com/lmiq) who is also the author of CellListMap.jl. He was a great help in understanding how to best use the neighbour-list algorithm. </p></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="functions/">Functions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Sunday 28 January 2024 14:19">Sunday 28 January 2024</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
